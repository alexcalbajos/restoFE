<div class="container shadow">
    <h3 class="uppercase">{{ 'BILLS' | translate }}</h3>
    <div class="input-with-icons">
        <input class="autocomplete"
            (keyup)="applyFilter($event.target.value)">
        <div class="icon-container">
            <div class="svg-container icon large"
                [inlineSVG]="'/assets/svg/search.svg'"></div>
        </div>
    </div>
    <div *ngIf="pages.length > 1"
        fxLayout="row wrap"
        fxLayoutAlign="end center"
        fxLayoutGap="3px"
        class="pages-row">
        <button *ngFor="let page of pages; let index = index"
            (click)="getBills(index + 1)"
            class="short thin"
            [ngClass]="{'accent-color' : activePage === index + 1}">{{ index + 1 }}</button>
    </div>
    <div *ngIf="!dataLoaded"
        class="spinner-container"
        fxLayout="column"
        fxLayoutAlign="center center">
        <mat-spinner diameter="30"></mat-spinner>
    </div>
    <div class="table-container">
        <table [ngClass]="{'invis': !dataLoaded}"
            mat-table
            [dataSource]="bills"
            matSort>
            <ng-container matColumnDef="num_complete"
                sticky>
                <th mat-header-cell
                    *matHeaderCellDef
                    mat-sort-header>{{ 'FIELDS_CARD_FULLNAME' | translate }}</th>
                <td mat-cell
                    *matCellDef="let bill">{{ bill.num_complete | translate }}</td>
            </ng-container>
            <ng-container matColumnDef="date">
                <th mat-header-cell
                    *matHeaderCellDef
                    mat-sort-header>{{ 'DATE' | translate }}</th>
                <td mat-cell
                    *matCellDef="let bill">{{ bill.date | date:'dd/MM/yy' }}</td>
            </ng-container>
            <ng-container matColumnDef="ft">
                <th mat-header-cell
                    *matHeaderCellDef
                    mat-sort-header>{{ 'AMOUNT' | translate }}</th>
                <td mat-cell
                    *matCellDef="let bill"><span *ngIf="bill.ft">{{ bill.ft | number : '1.2-2' }}&euro;</span></td>
            </ng-container>
            <ng-container matColumnDef="actions">
                <th mat-header-cell
                    *matHeaderCellDef
                    class="fixed-width">{{ 'ACTIONS' | translate }}</th>
                <td mat-cell
                    *matCellDef="let bill"
                    fxLayout="row"
                    fxLayoutGap="5px"
                    fxLayoutAlign="space-between center">
                    <button *ngIf="bill.recap_url"
                        (click)="download(bill.recap_url)">{{ 'Excel' | translate }}</button>
                    <button *ngIf="bill.document_url"
                        (click)="download(bill.document_url)">{{ 'Pdf' | translate }}</button>
                </td>
            </ng-container>
            <tr mat-header-row
                *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row
                *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
    </div>
</div>
